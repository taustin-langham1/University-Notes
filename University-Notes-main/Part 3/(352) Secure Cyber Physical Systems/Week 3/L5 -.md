Assumptions

 - some systems have no connectivity, or work on a private ad-hoc networks
 - some may interact in limited ways with online systems

not all attacks are going to be digital
not all systems will be running common software - custom embedded OS / code on bare metal

## Device capabilities

![[Pasted image 20251022092622.png]]

## Communication capabilities
![[Pasted image 20251022092818.png]]https://wballiance.com/guest-blog-wi-fi-lorawan-and-iot-convergence/

## Comparing Communication Protocols
![[Pasted image 20251022093023.png]]![[Pasted image 20251022093120.png]]


# IoT

**6LoWPAN and RPL**

- how are IoT devices addressed?
	- 6LoWPAN
- How are messages routed across an ad-hoc network of IoT devices?
	- RPL
- Overlay logical directed acyclic graph on network topology 
	- threats
		- is the traffic encrypted?
		- manipulate formation of tree

![[Pasted image 20251022093407.png]]


**Thread**

Another mesh network
high level of industrial support
focus on simplicity and security
custom protocol for node discovery and routing

high diversity in different approaches to mesh networking


**(CoAP) Constrained Application Protocol**

HTTP used to transfer information over the web
CoAP preferred in IoT deployments
used in client-server contexts
clients can act as servers

**CoAP** is much cheaper

different optimisation aims 
smaller message sizes
smaller implementation
less capable than HTTP

**MQTT**

lots of sensors, query the sensors, act upon that

- a publish/subscribe protocol
- devices subscribe to specific topic with a broker
- other devices publish information about that topic to the broker
- the broker forwards this information on to subscribed devices


## Encoding messaging - CBOR

text based protocols (XML, JSON, YAML,...) tend to have large payload sizes
existing binary protocols are not particularly efficient
CBOR encapsulates a stream of data where each item has a potentially different type

**CBOR Security Considerations**

hostile input may be constructed to overrun buffers, to overflow or underflow inter arithmetic, or to cause other decoding disruption.
CBOR data items might have lengths or sizes that are intentionally extremely large or too short.

Resource exhaustion attacks might attempt to lure a decoder into allocating very big data items (strings, arrays, maps, or even arbitrary precision numbers) or exhaust the stack depth by setting up deeply nested items. Decoders need to have appropriate resource management to mitigate these attacks. (Items for which very large sizes are given can also attempt to exploit integer overflow vulnerabilities.)


**Implications**

1. is there support for these protocols in penetration testing tools
2. are these specialised protocols as well tested compared to commonly used protocols
	1. more likely to be implementation vulnerabilities
	2. more likely to be design flaws in the protocol
3. how supported is the software? - more likely to be outdated?

### The impact can be much higher

os level security capabilities are often lower than linux/windows
	no segmentation of os and application memory 
	preemptive scheduling means trusting an application to yield control of the CPU

hardware security capabilities are often less capable
	limited memory isolation
	does the cpu support making memory as non-executable
limited resources and limited communication bandwidth can be exploited 


